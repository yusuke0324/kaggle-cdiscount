Using TensorFlow backend.
Found 9901446 images belonging to 5270 classes.
Found 2469847 images belonging to 5270 classes.
2017-10-09 05:07:39.888728: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-09 05:07:39.888784: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-09 05:07:39.888794: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
/home/ubuntu/work/kaggle-cdiscount/vgg16.py:39: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("se..., inputs=Tensor("in...)`
  model = Model(input=vgg16_model.input, output=top_model(vgg16_model.output))
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 180, 180, 3)       0         
_________________________________________________________________
block1_conv1 (Conv2D)        (None, 180, 180, 64)      1792      
_________________________________________________________________
block1_conv2 (Conv2D)        (None, 180, 180, 64)      36928     
_________________________________________________________________
block1_pool (MaxPooling2D)   (None, 90, 90, 64)        0         
_________________________________________________________________
block2_conv1 (Conv2D)        (None, 90, 90, 128)       73856     
_________________________________________________________________
block2_conv2 (Conv2D)        (None, 90, 90, 128)       147584    
_________________________________________________________________
block2_pool (MaxPooling2D)   (None, 45, 45, 128)       0         
_________________________________________________________________
block3_conv1 (Conv2D)        (None, 45, 45, 256)       295168    
_________________________________________________________________
block3_conv2 (Conv2D)        (None, 45, 45, 256)       590080    
_________________________________________________________________
block3_conv3 (Conv2D)        (None, 45, 45, 256)       590080    
_________________________________________________________________
block3_pool (MaxPooling2D)   (None, 22, 22, 256)       0         
_________________________________________________________________
block4_conv1 (Conv2D)        (None, 22, 22, 512)       1180160   
_________________________________________________________________
block4_conv2 (Conv2D)        (None, 22, 22, 512)       2359808   
_________________________________________________________________
block4_conv3 (Conv2D)        (None, 22, 22, 512)       2359808   
_________________________________________________________________
block4_pool (MaxPooling2D)   (None, 11, 11, 512)       0         
_________________________________________________________________
block5_conv1 (Conv2D)        (None, 11, 11, 512)       2359808   
_________________________________________________________________
block5_conv2 (Conv2D)        (None, 11, 11, 512)       2359808   
_________________________________________________________________
block5_conv3 (Conv2D)        (None, 11, 11, 512)       2359808   
_________________________________________________________________
block5_pool (MaxPooling2D)   (None, 5, 5, 512)         0         
_________________________________________________________________
sequential_1 (Sequential)    (None, 5270)              4631446   
=================================================================
Total params: 19,346,134
Trainable params: 11,710,870
Non-trainable params: 7,635,264
_________________________________________________________________
None
Epoch 1/10
